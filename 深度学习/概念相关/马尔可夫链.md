# 马尔可夫链
## 简单例子引入
![Drawing 2022-01-18 10.47.18.excalidraw](http://81.68.160.116:10001/%E4%B8%8A%E4%BC%A0/马尔可夫链.assets/Drawing 2022-01-18 10.47.18.excalidraw.svg)

如图所示，小明每天都要去这两家店买早餐

如果**前一天**小明选择了「早餐A」，那么**这一天**小明继续选择「早餐A」的概率为 $40\%$ ，转而选择「早餐B」的概率为 $60\%$ 

同理，今天如果选择「早餐B」就会影响第二天的选择

---
**总结：**
当日的选择，仅受**前一日的结果**以及**对应的转移概率**的影响，与再之前的选择**无关**
 ^ 上面这句话便包含了马尔可夫链的核心三要素

 ## 核心三要素
 1. 状态空间（States Space）
 2. 无记忆性（Memorylessness）
	 - 公式描述如下：
	 - $$ P(S_t | S_{t -1}, S_{t -2},S_{t -3}...) =  P(S_t | S_{t -1})$$
3. 转移矩阵（Transition Matrix）
	- 我们根据上例构建一个简单的转移矩阵：

	- |             | **A(前日)** | **B(前日)** |
	| :---------: | :---------: | :---------: |
	| **A(当日)** |    $0.4$    |    $0.5$    |
	| **B(当日)** |    $0.6$    |    $0.4$    |

## 状态概率分布推演及稳态分布
假设第一天选择了「早餐A」，那么其状态转移矩阵为 $\begin{bmatrix} 1\\0 \end{bmatrix}$
将其与转移矩阵相乘可以得到第二天的状态概率分布如下：
$$
\begin{bmatrix}
0.4 & 0.5 \\
0.6 & 0.5
\end{bmatrix}
\times
\begin{bmatrix}
1\\0
\end{bmatrix}
 = 
 \begin{bmatrix}
0.4\\0.6
\end{bmatrix}
$$
继续重复上述操作，我们可以得到第三天的概率分布：
$$
\begin{bmatrix}
0.4 & 0.5 \\
0.6 & 0.5
\end{bmatrix}^2
\times
\begin{bmatrix}
1\\0
\end{bmatrix}
 = 
 \begin{bmatrix}
0.46\\0.54
\end{bmatrix}
$$
继续推演下去，我们可以得到 **「稳态分布（Steady State Distribution）」**
$$
\begin{bmatrix}
0.4 & 0.5 \\
0.6 & 0.5
\end{bmatrix}^n
\times
\begin{bmatrix}
1\\0
\end{bmatrix}
 = 
 \begin{bmatrix}
0.454545\\0.545455
\end{bmatrix}
$$
### 特性
- 初始状态不同，**不影响**最终稳态分布的状态概率分布

**如：**
上述的例子中第一天选择的不是「早餐A」，而是「早餐B」
那么其最终的结果：
$$
\begin{bmatrix}
0.4 & 0.5 \\
0.6 & 0.5
\end{bmatrix}^n
\times
\begin{bmatrix}
0\\1
\end{bmatrix}
 = 
 \begin{bmatrix}
0.454545\\0.545455
\end{bmatrix}
$$
可以看到稳态分布是没有变化的

- 并不是所有的马尔可夫链都具有唯一稳态分布

比如下面的马尔可夫链：

  ![Drawing 2022-01-18 11.58.23.excalidraw](http://81.68.160.116:10001/%E4%B8%8A%E4%BC%A0/马尔可夫链.assets/Drawing 2022-01-18 11.58.23.excalidraw.svg)

A 根据相应的额转移概率，分别与 B C 单向连接



 一旦进入到 B 或 C 种，均再对应状态下自循环，无法达到其他的状态



上图所示的马尔可夫链的稳态分布数大于 $1$

- B 下的稳态分布：
	- $\begin{bmatrix} 0 \\ 1 \\ 0 \end{bmatrix}\begin{matrix} (A) \\ (B) \\ (C) \end{matrix}$
	
- C 下的稳态分布：
	- $\begin{bmatrix} 0 \\ 0 \\ 1 \end{bmatrix}\begin{matrix} (A) \\ (B) \\ (C) \end{matrix}$

## 马尔可夫链的应用
- 在 NLP 领域，我们可以根据字符、词语之间的转移矩阵去联想用户接下来想要说什么，想搜索什么内容
- 其他领域如 股票价格预测、信用评级 等，均有马尔可夫链的应用